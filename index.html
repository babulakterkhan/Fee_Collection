<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <title>‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤ ‡¶´‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü - SMS ‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶∂‡¶®</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f0f2f5; padding: 20px; color: #333; }
        .container { max-width: 1200px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .school-header { text-align: center; margin-bottom: 25px; border-bottom: 2px solid #1a73e8; padding-bottom: 15px; }
        #headerName { margin: 0; color: #1a73e8; }
        .settings-panel { display: none; background: #fffde7; border: 1px dashed #fbc02d; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .input-box { background: #e3f2fd; padding: 20px; border-radius: 10px; margin-bottom: 20px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }
        .full-row { grid-column: span 4; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
        th { background-color: #1a73e8; color: white; }
        .btn { padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; color: white; }
        .btn-save { background: #2e7d32; width: 100%; font-size: 16px; margin-top: 10px; }
        input, select { padding: 10px; border: 1px solid #ccc; border-radius: 4px; width: 100%; }
    </style>
</head>
<body>

<div class="container">
    <div class="school-header">
        <h1 id="headerName">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</h1>
        <p id="headerAddress">‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...</p>
        <button onclick="openSettings()" class="btn" style="background:#546e7a;">‚öôÔ∏è ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</button>
    </div>

    <div id="settingsArea" class="settings-panel">
        <h3>üõ† SMS ‡¶ì ‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®</h3>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <input type="text" id="setSchoolName" placeholder="‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ">
            <input type="text" id="setSchoolAddr" placeholder="‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ">
            <input type="text" id="setSmsApiKey" placeholder="API Key (‡¶â‡¶¶‡¶æ: 1234567890)">
            <input type="text" id="setSenderID" placeholder="Sender ID (‡¶â‡¶¶‡¶æ: 88017...)">
        </div>
        <button onclick="saveSettings()" class="btn" style="background:#2e7d32; margin-top:10px;">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>

    <div class="input-box">
        <div><label>‡¶∞‡ßã‡¶≤:</label><input type="number" id="rollInput" oninput="findStudent()"></div>
        <div><label>‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø:</label><select id="classSelect" onchange="findStudent()"><option value="One">One</option><option value="Ten">Ten</option></select></div>
        <div style="grid-column: span 2;"><label>‡¶®‡¶æ‡¶Æ:</label><div id="studentNameDisplay" style="font-weight:bold; padding:10px; background:#fff; border:1px solid #ccc;">‡¶∞‡ßã‡¶≤ ‡¶¶‡¶ø‡¶®...</div></div>
        
        <div class="full-row">
            <label>‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß‡¶ø‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ:</label>
            <input type="number" id="paidAmount" placeholder="0">
        </div>
        <div class="full-row">
            <button onclick="saveAndSend()" class="btn btn-save">‡¶∏‡ßá‡¶≠ ‡¶ì SMS ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
        </div>
    </div>

    <table id="feeTable">
        <thead>
            <tr><th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th><th>‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶∞‡ßã‡¶≤</th><th>‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</th><th>‡¶Ü‡¶¶‡¶æ‡ßü</th></tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
</div>

<script>
    const students = [
        { roll: 101, class: "One", name: "‡¶∞‡¶π‡¶ø‡¶Æ ‡¶Ü‡¶π‡¶Æ‡ßá‡¶¶", mobile: "8801715082325" }, // ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á 88 ‡¶¶‡¶ø‡ßü‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®
        { roll: 102, class: "One", name: "‡¶∏‡¶æ‡¶¨‡ßç‡¶¨‡¶ø‡¶∞ ‡¶π‡ßã‡¶∏‡ßá‡¶®", mobile: "8801800000000" }
    ];

    window.onload = function() {
        loadSettings();
        updateTable();
    };

    function loadSettings() {
        const config = JSON.parse(localStorage.getItem('appConfig')) || { name: "‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ", addr: "‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ", smsKey: "", sender: "" };
        document.getElementById('headerName').innerText = config.name;
        document.getElementById('headerAddress').innerText = config.addr;
        document.getElementById('setSchoolName').value = config.name;
        document.getElementById('setSmsApiKey').value = config.smsKey;
        document.getElementById('setSenderID').value = config.sender;
    }

    function saveSettings() {
        const config = {
            name: document.getElementById('setSchoolName').value,
            addr: document.getElementById('setSchoolAddr').value,
            smsKey: document.getElementById('setSmsApiKey').value,
            sender: document.getElementById('setSenderID').value,
            pass: "1234"
        };
        localStorage.setItem('appConfig', JSON.stringify(config));
        location.reload();
    }

    function openSettings() {
        if(prompt("‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®:") === "1234") document.getElementById('settingsArea').style.display = "block";
    }

    function findStudent() {
        const roll = document.getElementById('rollInput').value;
        const cls = document.getElementById('classSelect').value;
        const s = students.find(x => x.roll == roll && x.class == cls);
        document.getElementById('studentNameDisplay').innerText = s ? s.name : "‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø";
    }

    function saveAndSend() {
        const roll = document.getElementById('rollInput').value;
        const cls = document.getElementById('classSelect').value;
        const amount = document.getElementById('paidAmount').value;
        const student = students.find(x => x.roll == roll && x.class == cls);
        const config = JSON.parse(localStorage.getItem('appConfig'));

        if(!student || !amount) { alert("‡¶∏‡¶¨ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!"); return; }

        // ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠
        let history = JSON.parse(localStorage.getItem('feeHistory')) || [];
        history.push({ date: new Date().toLocaleDateString(), name: student.name, roll: roll, class: cls, paid: amount });
        localStorage.setItem('feeHistory', JSON.stringify(history));

        // SMS ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶á‡¶Æ‡ßá‡¶ú ‡¶ó‡ßá‡¶ü‡¶ì‡ßü‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ (‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡¶¨‡ßá ‡¶®‡¶æ)
        const msg = `Dhonnobad, ${student.name}-er fee ${amount} taka pawa geche. - ${config.name}`;
        
        // BDBulkSMS ‡¶¨‡¶æ GreenWeb ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø URL (Image tag technique)
        const smsUrl = `https://api.greenweb.com.bd/api.php?json&apikey=${config.smsKey}&to=${student.mobile}&message=${encodeURIComponent(msg)}`;
        
        // ‡¶è‡¶ü‡¶ø ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ß‡¶æ ‡¶ü‡¶™‡¶ï‡ßá ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶™‡¶æ‡¶†‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶¨‡ßá
        const img = new Image();
        img.src = smsUrl;

        alert("‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç SMS ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
        updateTable();
    }

    function updateTable() {
        let history = JSON.parse(localStorage.getItem('feeHistory')) || [];
        let html = "";
        history.reverse().forEach(x => {
            html += `<tr><td>${x.date}</td><td>${x.name} (${x.roll})</td><td>${x.class}</td><td>${x.paid}</td></tr>`;
        });
        document.getElementById('tableBody').innerHTML = html;
    }
</script>
</body>
</html>